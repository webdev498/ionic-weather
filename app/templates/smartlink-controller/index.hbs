<header class="bar bar-nav weathermatic-header">
  {{#link-to 'site' class='btn btn-link btn-nav pull-left'}}
    <span class="icon icon-left-nav"></span>
  {{/link-to}}
  <h1 class="title">{{fa-icon 'signal'}} {{short-text model.site.name size=10}} - {{short-text model.name size=10}}</h1>
  <a href="javascript:void(0)" class="icon icon-refresh pull-right" {{action 'refreshData'}}></a>
</header>


<div id="smartlink-controller-container" class="content weathermatic-content">
  <div class="content-padded">
    {{#if model.canRunCommands}}
      <div class="card">
        <ul class="table-view">
          <li class="table-view-cell table-view-divider">
            {{fa-icon 'wrench'}} Actions
          </li>
          <li class="table-view-cell">
            {{#link-to 'smartlink-controller.select-program' class='push-right'}}
              {{fa-icon 'play'}} Run Program
            {{/link-to}}
          </li>
          <li class="table-view-cell">
            {{#link-to 'smartlink-controller.select-zone' class='push-right'}}
              {{fa-icon 'leaf'}} Run Zone
              {{/link-to}}
          </li>
          <li class="table-view-cell">
            {{#link-to 'smartlink-controller.select-valves' class='push-right'}}
              {{fa-icon 'crosshairs'}} Locate Valve
            {{/link-to}}
          </li>
          <li class="table-view-cell">
            {{#link-to 'smartlink-controller.walk-site' class='push-right'}}
              {{fa-icon 'male'}} Walk Site
            {{/link-to}}
          </li>
        </ul>
      </div>

      {{#link-to 'smartlink-controller.stop-all' class='btn btn-block btn-negative'}}
        {{fa-icon 'stop'}} Stop All
      {{/link-to}}
    {{else}}
      <span class="btn btn-block btn-negative btn-outlined">
        <h3>{{fa-icon 'warning'}} Limited Access</h3>
        <p>It looks like you are not allowed to run <br>remote commands on this controller</p>
      </span>
    {{/if}}
  </div>

  {{#if isLoading}}
    <div class="content-padded weathermatic-smartlink-controller-loading">
      <center>
        <!-- why this looks so weird??? -->
        <i class="fa fa-refresh fa-spin fa-lg"></i>
      </center>
      <br>
    </div>
  {{/if}}

  <ul class="table-view">
    <li class="table-view-cell table-view-divider">
      {{fa-icon 'gears'}} Controller Details
    </li>
    <li class="table-view-cell">
      Status
      {{#if model.isRunning}}
        <button class="btn btn-positive">Running</button>
      {{else}}
        <button class="btn btn-primary">Stopped</button>
      {{/if}}
    </li>
    <li class="table-view-cell">
      Watering Mode
      {{#if model.isSmartWateringMode}}
        <button class="btn btn-positive">Smart</button>
      {{else}}
        <button class="btn btn-primary">Manual</button>
      {{/if}}
    </li>
    <li class="table-view-cell">
      Rain/Freeze
      {{#if model.isRainFreezeSensorEnabled}}
        <button class="btn btn-positive">Active</button>
      {{else}}
        <button class="btn btn-negative">Bypass</button>
      {{/if}}
    </li>
    <li class="table-view-cell">
      Weather
      {{#if model.weather.length}}
        <button {{bind-attr class='model.isWeatherBad:btn-negative:btn-positive :btn'}}>
          {{model.weather}}
        </button>
      {{/if}}
    </li>

    {{#if model.faults.length}}
      <li class="table-view-cell table-view-divider">
        {{fa-icon 'warning'}} Faults <span class="badge badge-negative">{{model.faults.length}}</span>
      </li>
    {{/if}}
  </ul>

  {{#if model.faults.length}}
    <div class="content-padded weathermatic-controller-details-faults">
      {{#each fault in model.faults}}
        <button class="btn btn-negative">{{fault.description}}</button>
      {{/each}}

      {{#if model.canRunCommands}}
        {{#link-to 'smartlink-controller.clear-faults' class='btn btn-block btn-primary'}}
          {{fa-icon 'fa-refresh'}} Clear Faults
        {{/link-to}}
      {{/if}}
    </div>
  {{/if}}
</div>
