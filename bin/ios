#!/bin/bash
set -e

DIR=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )

echo "Killing XCode..."
xcodepids=$(ps aux | grep 'Xcod[e]' | awk '{print $2}')
if [ "$xcodepids" ]; then
  kill $xcodepids;
fi
echo "It's dead"

echo "Removing old XCode project"
ember cordova platform remove ios

echo "Adding ios platform"
ember cordova platform add ios

echo "Adding plugins"
ember cordova plugin add org.apache.cordova.geolocation
ember cordova plugin add org.apache.cordova.statusbar
ember cordova plugin add org.apache.cordova.console

echo "Building XCode project"
MOBILE_PLATFORM=ios ember cordova:build ${EMBER_ENV:=development}

echo "Opening XCode project"
ember cordova:open
